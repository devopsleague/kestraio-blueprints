id: working_dir_python_git_clone
namespace: sanitychecks

variables:
  branch: main

tasks:

  - id: working_dir
    type: io.kestra.plugin.core.flow.WorkingDirectory
    tasks:
      - id: git_clone
        type: io.kestra.plugin.git.Clone
        url: https://github.com/kestra-io/scripts
        branch: "{{ vars.branch }}"
      
      - id: python
        type: io.kestra.plugin.scripts.python.Commands
        beforeCommands:
          - pip install faker
        commands:
          - python generate_data/generate_orders.py

  - id: assert
    type: io.kestra.plugin.core.execution.Assert
    conditions:
      - "{{ outputs.python.vars.total_sum > 0}}"
      - "{{ outputs.python.vars.average_order > 0}}"
